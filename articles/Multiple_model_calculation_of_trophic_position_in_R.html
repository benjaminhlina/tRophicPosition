<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using tRophicPosition to estimate TP through the use of multiple models • tRophicPosition</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using tRophicPosition to estimate TP through the use of multiple models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tRophicPosition</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Multiple_model_calculation_of_trophic_position_in_R.html">Using tRophicPosition to estimate TP through the use of multiple models</a></li>
    <li><a class="dropdown-item" href="../articles/Multiple_species_calculation_of_trophic_position_in_R_1.html">tRophicPosition: calculating trophic position for multiple species</a></li>
    <li><a class="dropdown-item" href="../articles/Short_guide_to_tRophicPosition.html">Short guide to the use of tRophicPosition</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/clquezada/tRophicPosition/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using tRophicPosition to estimate TP through the use of multiple models</h1>
                        <h4 data-toc-skip class="author">Claudio
Quezada-Romegialli, Andrew L Jackson &amp; Chris Harrod</h4>
            
            <h4 data-toc-skip class="date">December 11 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/clquezada/tRophicPosition/blob/master/vignettes/Multiple_model_calculation_of_trophic_position_in_R.Rmd" class="external-link"><code>vignettes/Multiple_model_calculation_of_trophic_position_in_R.Rmd</code></a></small>
      <div class="d-none name"><code>Multiple_model_calculation_of_trophic_position_in_R.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="trophicposition">tRophicPosition<a class="anchor" aria-label="anchor" href="#trophicposition"></a>
</h2>
<p><code>tRophicPosition</code>, is an R package incorporating a
Bayesian model for the calculation of trophic position using stable
isotopes with one or two baselines. As of 2022-12-11, the current
version of the package is 0.8. <code>tRophicPosition</code> uses the
powerful approach of Markov Chain Monte Carlo simulations provided by <a href="https://mcmc-jags.sourceforge.io/" class="external-link">JAGS</a> and the statistical
language <a href="https://www.r-project.org" class="external-link">R</a>. Vignettes can be
browsed with <code>browseVignettes("tRophicPosition")</code>.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette, we will introduce the new functions we have
developed for <code>tRophicPosition</code> in the version 0.6.8. These
functions are <code><a href="../reference/multiModelTP.html">multiModelTP()</a></code>,
<code><a href="../reference/credibilityIntervals.html">credibilityIntervals()</a></code>, <code><a href="../reference/pairwiseComparisons.html">pairwiseComparisons()</a></code>
and <code><a href="../reference/parametricTP.html">parametricTP()</a></code>. Each of these functions accomplish
different tasks within the Bayesian estimation of trophic position with
stable isotopes, facilitating the calculation of multiple models (either
one, two baselines and/or two baselines full model of trophic position)
for a single species, pairwise comparisons of posterior estimates of
trophic position and/or alpha parameters, plotting of credibility
intervals of posterior estimates of trophic position and/or alpha, and
calculation of a parametric (non-Bayesian) estimate of trophic
position.</p>
<div class="section level3">
<h3 id="installing-and-loading-the-package">Installing and loading the package<a class="anchor" aria-label="anchor" href="#installing-and-loading-the-package"></a>
</h3>
<div class="section level4">
<h4 id="stable-version---cran">Stable version - CRAN<a class="anchor" aria-label="anchor" href="#stable-version---cran"></a>
</h4>
<p>First of all, you need to install <a href="https://mcmc-jags.sourceforge.io/" class="external-link">JAGS</a> for your platform, and
then install the stable version of <code>tRophicPosition</code> from <a href="https://CRAN.R-project.org/package=tRophicPosition" class="external-link">CRAN</a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tRophicPosition"</span><span class="op">)</span></span></code></pre></div>
<p>After that, you have to load the package with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/clquezada/tRophicPosition" class="external-link">tRophicPosition</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="development-version---github">Development version - GitHub<a class="anchor" aria-label="anchor" href="#development-version---github"></a>
</h4>
<p>If you want to install the development version of
<code>tRophicPosition</code>, you must install it from GitHub. For this,
we use the function <code>install_github()</code> from the package
<code>devtools</code> (installation instructions <a href="https://github.com/r-lib/devtools#updating-to-the-latest-version-of-devtools" class="external-link">here</a>),
which needs to be installed previously (either from <a href="https://CRAN.R-project.org/package=devtools" class="external-link">CRAN</a> or <a href="https://github.com/r-lib/devtools" class="external-link">GitHub</a>):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span></code></pre></div>
<p>If you are working in Windows, <code>devtools</code> also requires <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">Rtools</a>, or if
you are working on a Mac, <a href="https://developer.apple.com/xcode/" class="external-link">Xcode</a> (from Apple Store).
In Linux you will need to install a compiler and various development
libraries.</p>
<p>Besides installing <code>devtools</code>, you must also install <a href="https://mcmc-jags.sourceforge.io/" class="external-link">JAGS</a> (Just Another Gibbs
Sampler), which is at the core of the Bayesian model analysis supporting
<code>tRophicPosition</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install_github</span><span class="op">(</span><span class="st">"clquezada/tRophicPosition"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>After installing <code>tRophicPosition</code>, it should be loaded
into memory, which automatically reports the version of the software (we
need at least 0.6.8-8 to use the routines described in this
vignette).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/clquezada/tRophicPosition" class="external-link">tRophicPosition</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## This is tRophicPosition 0.8.0</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="future-releases-and-how-to-get-support">Future releases and how to get support<a class="anchor" aria-label="anchor" href="#future-releases-and-how-to-get-support"></a>
</h3>
<p>You are encouraged to use <code>tRophicPosition</code> with your own
data, test the package and see if there are any issues or problems. You
can send your questions or commentaries to the google group <a href="https://groups.google.com/d/forum/trophicposition-support" class="external-link">tRophicPosition-support</a>
or directly to the email <a href="mailto:trophicposition-support@googlegroups.com" class="email">trophicposition-support@googlegroups.com</a>. You can send
your questions to <a href="https://stackexchange.com/" class="external-link uri">https://stackexchange.com/</a> <a href="https://stackoverflow.com/" class="external-link uri">https://stackoverflow.com/</a> or even <a href="https://www.facebook.com/groups/stableisotopes/" class="external-link">Facebook (stable
isotope ecology group)</a>.</p>
<p>We are constantly working on future releases of
<code>tRophicPosition</code>, so feedback is very much appreciated.</p>
</div>
</div>
<div class="section level2">
<h2 id="calculation-of-tp-for-one-species-using-multiple-bayesian-models">Calculation of TP for one species using multiple Bayesian
models<a class="anchor" aria-label="anchor" href="#calculation-of-tp-for-one-species-using-multiple-bayesian-models"></a>
</h2>
<p>To demonstrate how <code>tRophicPosition</code> works, we will
simulate some data. For example, imagine we have a fish species of
interest that has mean
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
SD) values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>δ</mi><mn>15</mn></msup><annotation encoding="application/x-tex">\delta^{15}</annotation></semantics></math>N
of 21‰
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
1‰), and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>δ</mi><mn>13</mn></msup><annotation encoding="application/x-tex">\delta^{13}</annotation></semantics></math>C
of -15‰
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
1‰). Also, as in many aquatic ecosystems, this fish lives in a system
with two sources of C and N, meaning that we have to deal with two
different baselines. One of the baselines has mean
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
SD) values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>δ</mi><mn>15</mn></msup><annotation encoding="application/x-tex">\delta^{15}</annotation></semantics></math>N
of 14.2‰
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
1‰) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>δ</mi><mn>13</mn></msup><annotation encoding="application/x-tex">\delta^{13}</annotation></semantics></math>C
-17.3‰
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
1‰), while the other baseline has mean values of 15.4‰
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
1‰) and -12.7‰
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
1‰)
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>δ</mi><mn>15</mn></msup><annotation encoding="application/x-tex">\delta^{15}</annotation></semantics></math>N
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>δ</mi><mn>13</mn></msup><annotation encoding="application/x-tex">\delta^{13}</annotation></semantics></math>C
respectively). We will use the function generateTPData() to simulate
this simple ecosystem.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">consumer1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generateTPData.html">generateTPData</a></span><span class="op">(</span>dCb1 <span class="op">=</span> <span class="op">-</span><span class="fl">17.3</span>, dNb1 <span class="op">=</span> <span class="fl">14.2</span>,</span>
<span>                            dCc <span class="op">=</span> <span class="op">-</span><span class="fl">15</span>, dNc <span class="op">=</span> <span class="fl">21</span>,</span>
<span>                            dCb2 <span class="op">=</span> <span class="op">-</span><span class="fl">12.7</span>, dNb2 <span class="op">=</span> <span class="fl">15.4</span>,</span>
<span>                            DeltaN <span class="op">=</span> <span class="fl">3.4</span>, sd.DeltaN <span class="op">=</span> <span class="fl">0.98</span>,</span>
<span>                            DeltaC <span class="op">=</span> <span class="fl">0.39</span>, sd.DeltaC <span class="op">=</span> <span class="fl">1.3</span>,</span>
<span>                            consumer <span class="op">=</span> <span class="st">"Consumer 1"</span><span class="op">)</span></span></code></pre></div>
<p>In this function we have also indicated mean and sd values for
trophic discrimination factors for <code>DeltaN</code>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>N)
and <code>DeltaC</code>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>C),
and also have indicated a name for the consumer. Remember that all the
functions have a help page where you will find other options (write for
example <code><a href="../reference/generateTPData.html">?generateTPData</a></code> in the console).</p>
<p>Now that we have our simple ecosystem simulated, we will plot it:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">consumer1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Multiple_model_calculation_of_trophic_position_in_R_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>In this figure we can see that sample of simulated fish consumers is
exactly located in-between both baselines on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>δ</mi><mn>13</mn></msup><annotation encoding="application/x-tex">\delta^{13}</annotation></semantics></math>C
axis, and also, our fish is 6.8‰ above the baseline 1 in terms of its
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>δ</mi><mn>15</mn></msup><annotation encoding="application/x-tex">\delta^{15}</annotation></semantics></math>N
value. If we use a one baseline model, and if the trophic level of
baseline 1 (<code>lambda</code>) is 2, we would expect a mean trophic
position of 4 for our simulated fish species. If we use a two baselines
model without fractionation for carbon, we would expect an
<code>alpha</code> value of 0.5, which means that each baseline is
contributing in 50% of the energy inputs to our fish. Finally, if we use
a two baselines full model (including fractionation for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>δ</mi><mn>13</mn></msup><annotation encoding="application/x-tex">\delta^{13}</annotation></semantics></math>C),
the trophic position of our fish would depend on both baselines, and the
relative contribution of each baseline would depend on the trophic
discrimination factors
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>N
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>C).
Clearly, this is worth exploring more, so we will calculate (and
compare) estimates for TP using these models with the function
<code><a href="../reference/multiModelTP.html">multiModelTP()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">consumer1_models</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multiModelTP.html">multiModelTP</a></span><span class="op">(</span><span class="va">consumer1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Compiling model graph</span></span>
<span><span class="co">##    Resolving undeclared variables</span></span>
<span><span class="co">##    Allocating nodes</span></span>
<span><span class="co">## Graph information:</span></span>
<span><span class="co">##    Observed stochastic nodes: 106</span></span>
<span><span class="co">##    Unobserved stochastic nodes: 31</span></span>
<span><span class="co">##    Total graph size: 149</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Initializing model</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Compiling model graph</span></span>
<span><span class="co">##    Resolving undeclared variables</span></span>
<span><span class="co">##    Allocating nodes</span></span>
<span><span class="co">## Graph information:</span></span>
<span><span class="co">##    Observed stochastic nodes: 206</span></span>
<span><span class="co">##    Unobserved stochastic nodes: 14</span></span>
<span><span class="co">##    Total graph size: 243</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Initializing model</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Compiling model graph</span></span>
<span><span class="co">##    Resolving undeclared variables</span></span>
<span><span class="co">##    Allocating nodes</span></span>
<span><span class="co">## Graph information:</span></span>
<span><span class="co">##    Observed stochastic nodes: 313</span></span>
<span><span class="co">##    Unobserved stochastic nodes: 66</span></span>
<span><span class="co">##    Total graph size: 404</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Initializing model</span></span></code></pre>
<p><code>multiModelsTP()</code> requires an object of the class
<code>isotopeData</code>, which was created previously by the function
<code><a href="../reference/generateTPData.html">generateTPData()</a></code>. By default <code>multiModelsTP()</code>
defines a <code>lambda = 2</code> for the baselines, uses 2 chains
(<code>n.chains = 2</code>) to do the Bayesian calculation with 20,000
adaptive iterations (<code>n.adapt = 20000</code>), 20,000 actual
iterations (<code>n.iter = 20000</code>), 20,000 iterations as burnin
(<code>burnin = 20000</code>) and a thinning of 10
(<code>thin = 10</code>). Furthermore, it estimates TP using three
different Bayesian models: one baseline, two baselines and two baselines
full
(<code>models = c("oneBaseline", "twoBaselines", "twoBaselinesFull"</code>).
The default setting is to limit the amount of output for each model run
(print = FALSE). NB: The user can change any of these options, simply
adding them as arguments to <code><a href="../reference/multiModelTP.html">multiModelTP()</a></code>, see
<code>?multiModelTP()</code> for details.</p>
<p>Also, by default this function uses Post’s (2002) assumptions on TDF
(i.e. 56 values with mean 3.4
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
0.98 SD for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>N
and 107 values with mean 0.39
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
1.3 SD for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>C).</p>
<p>For example, if we have used the option <code>print = TRUE</code> as
argument (i.e. <code>multiModelTP(print = TRUE)</code>), we would have a
trace plot for every model (to check graphically if our parameters of
interest <code>TP</code>, <code>muDeltaN</code> and <code>alpha</code>
have converged), and if more than 1 chain were used, also would have
printed two statistics from the coda package: Gelman and Rubin’s
convergence diagnostic statistics (see ?gelman.diag for a detailed
explanation). Basically, we expect that potential scale reduction
factors for each parameter is close to 1, which means that our model has
converged and it is reliable.</p>
<p>These estimates have been generated using Post’s (2002) mean
estimates for TDFs, which are commonly used across a wide range of
ecological studies. Now that we have calculated the trophic position for
our simulated fish in a simple ecosystem, we will do the same
calculation, but this time, we will change the trophic discrimination
factor from Post’s (2002) values to McCutchan’s et al. (2003) values in
order to examine the sensitivity of the models to TDF estimates. To do
this, we will we will generate <code>consumer2</code> with the same
isotope values as <code>consumer1</code> and simply change the variables
<code>deltaN</code> and <code>deltaC</code> within the object
<code>consumer2</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">consumer2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generateTPData.html">generateTPData</a></span><span class="op">(</span>dCb1 <span class="op">=</span> <span class="op">-</span><span class="fl">17.3</span>, dNb1 <span class="op">=</span> <span class="fl">14.2</span>,</span>
<span>                            dCc <span class="op">=</span> <span class="op">-</span><span class="fl">15</span>, dNc <span class="op">=</span> <span class="fl">21</span>,</span>
<span>                            dCb2 <span class="op">=</span> <span class="op">-</span><span class="fl">12.7</span>, dNb2 <span class="op">=</span> <span class="fl">15.4</span>,</span>
<span>                            consumer <span class="op">=</span> <span class="st">"Consumer 2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">consumer2</span><span class="op">$</span><span class="va">deltaN</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TDF.html">TDF</a></span><span class="op">(</span>author <span class="op">=</span> <span class="st">"McCutchan"</span>, element <span class="op">=</span> <span class="st">"N"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## You selected McCutchan's et al (2003)</span></span>
<span><span class="co">##                   All d15N: 73 values with mean 2.3 +- 0.18 se</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">consumer2</span><span class="op">$</span><span class="va">deltaC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TDF.html">TDF</a></span><span class="op">(</span>author <span class="op">=</span> <span class="st">"McCutchan"</span>, element <span class="op">=</span> <span class="st">"C"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## You selected McCutchan's et al (2003)</span></span>
<span><span class="co">##                   All d13C: 102 values with mean 0.5 +- 0.13 se</span></span></code></pre>
<p>And now we will calculate the three Bayesian models of trophic
position again, with the only difference being we have changed their TDF
values.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">consumer2_models</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multiModelTP.html">multiModelTP</a></span><span class="op">(</span><span class="va">consumer2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Compiling model graph</span></span>
<span><span class="co">##    Resolving undeclared variables</span></span>
<span><span class="co">##    Allocating nodes</span></span>
<span><span class="co">## Graph information:</span></span>
<span><span class="co">##    Observed stochastic nodes: 123</span></span>
<span><span class="co">##    Unobserved stochastic nodes: 31</span></span>
<span><span class="co">##    Total graph size: 166</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Initializing model</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Compiling model graph</span></span>
<span><span class="co">##    Resolving undeclared variables</span></span>
<span><span class="co">##    Allocating nodes</span></span>
<span><span class="co">## Graph information:</span></span>
<span><span class="co">##    Observed stochastic nodes: 223</span></span>
<span><span class="co">##    Unobserved stochastic nodes: 14</span></span>
<span><span class="co">##    Total graph size: 260</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Initializing model</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Compiling model graph</span></span>
<span><span class="co">##    Resolving undeclared variables</span></span>
<span><span class="co">##    Allocating nodes</span></span>
<span><span class="co">## Graph information:</span></span>
<span><span class="co">##    Observed stochastic nodes: 325</span></span>
<span><span class="co">##    Unobserved stochastic nodes: 66</span></span>
<span><span class="co">##    Total graph size: 416</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Initializing model</span></span></code></pre>
<p>In both cases we have calculated three Bayesian models (one baseline,
two baselines without fractionation for C, and two baselines full model
with C fractionation) for two simulated simple ecosystems consisting of
one fish and 2 baselines, and the only difference between consumer 1 and
consumer 2 is the trophic discrimination factor. In the first case we
included Post’s (2002) values, and in the second case we included
McCutchan’s et al. (2003) values for both N and C. We have saved the
output of <code><a href="../reference/multiModelTP.html">multiModelTP()</a></code> into two objects
<code>consumer1_models</code> and <code>consumer2_models</code>, and now
we will analyze the results.</p>
<p>If you are using RStudio, in the environment tab you will see that
both <code>consumer1_models</code> and <code>consumer2_models</code> are
lists of 4 elements each. The first element is a data frame named TP.
This dataframe has the posterior samples of TP for each model. The
second element is also a data frame, named alpha in this case, which
includes the posterior samples of alpha for 2 of the 3 models (only the
two baselines models calculate alpha, i.e. the relative contribution of
the baseline 1). The third element is a data frame as well, named gg (to
indicate us that has the structure required to use the ggplot2 package).
This data frame has summary values of both posterior samples of trophic
position and alpha: median and 95% credibility interval, grouped by
model, community and species. The fourth and last element is a list of 3
elements named samples, that has raw posterior mcmc samples if you want
to summarise the information, or analyze it in a different way. The
first three elements (data frames TP, alpha and gg) are based in these
raw posterior samples of every Bayesian model, summarised by
<code>multiModelsTP()</code> for convenience.</p>
<p>We can produce a detailed summary of the structure described above
using the function <code><a href="https://rdrr.io/r/utils/str.html" class="external-link">str()</a></code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">consumer1_models</span><span class="op">)</span></span></code></pre></div>
<p>In order to plot the mode and 95% credibility interval for both
posterior trophic position and alpha, we can use the function
<code>credibilityIntervals():</code></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For consumer 1 (based on Post's (2002) TDF values)</span></span>
<span><span class="fu"><a href="../reference/credibilityIntervals.html">credibilityIntervals</a></span><span class="op">(</span><span class="va">consumer1_models</span><span class="op">$</span><span class="va">gg</span>, x <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Multiple_model_calculation_of_trophic_position_in_R_files/figure-html/unnamed-chunk-17-1.png" width="576"></p>
<p>This figure provides mode
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
95% credibility interval) for posterior estimates trophic position from
the three different models (one baseline two baselines and two baselines
full), as well as alpha (only given for two baselines models).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For consumer 2 (based on McCutchan's (2003) TDF values)</span></span>
<span><span class="fu"><a href="../reference/credibilityIntervals.html">credibilityIntervals</a></span><span class="op">(</span><span class="va">consumer2_models</span><span class="op">$</span><span class="va">gg</span>, x <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Multiple_model_calculation_of_trophic_position_in_R_files/figure-html/unnamed-chunk-18-1.png" width="576"></p>
<p>The arguments <code>df = consumer1_models$gg</code> and
<code>x = model</code> above, tells the function
<code><a href="../reference/credibilityIntervals.html">credibilityIntervals()</a></code> to plot the data frame
<code>consumer1_models$gg</code> using the model column within that data
frame as the independent variable (<code>x</code>), and by default using
the mode as the central tendency descriptor (see
<code><a href="../reference/credibilityIntervals.html">credibilityIntervals()</a></code> for details). If you want to plot
the median instead of the mode add <code>y1 = "median</code> and
<code>y2 = "alpha.median"</code> as arguments within
<code><a href="../reference/credibilityIntervals.html">credibilityIntervals()</a></code>. When we have multiple species or
several communities we will change this (e.g. see the vignette multiple
species calculation of trophic position).</p>
<div class="section level3">
<h3 id="why-we-need-of-accurate-trophic-discrimination-factors-tdf">Why we need of accurate trophic discrimination factors (TDF)?<a class="anchor" aria-label="anchor" href="#why-we-need-of-accurate-trophic-discrimination-factors-tdf"></a>
</h3>
<p>Probably, the single and most important assumption to get accurate
and reliable estimations of trophic position is the <em>trophic
discrimination factor</em>, either for nitrogen
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Δ</mi><mn>15</mn></msup><annotation encoding="application/x-tex">\Delta^{15}</annotation></semantics></math>N
(one and two baselines models) and both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>N
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>C
for the two baselines full model. Obviously, the use of a
non-representative TDF estimate for either
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>N
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>C
can affect both trophic position estimations and the alpha
parameter.</p>
<p>Now we will examine the impact of using the different TDFs for our
simulated consumers. We have estimated trophic position and alpha for
both consumers groups (differing only in TDF) and will test for
statistical differences between posterior samples of these parameters.
First, we must change the names of both posterior samples, because they
have the same name (as they were calculated with
<code>multiModelsTP()</code>):</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Here we see that we have 4002 posterior samples of 3 parameters</span></span>
<span><span class="co"># (one for each Bayesian model) for consumer1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">consumer1_models</span><span class="op">$</span><span class="va">TP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 3</span></span>
<span><span class="co">##  $ 1b : num [1:4002] 4.09 3.91 3.94 3.73 3.93 ...</span></span>
<span><span class="co">##  $ 2b : num [1:4002] 3.74 3.77 3.8 3.99 3.7 ...</span></span>
<span><span class="co">##  $ 2bf: num [1:4002] 4.17 3.79 3.85 3.83 3.71 ...</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># And also 4002 posterior samples (for each 3 Bayesian models) for consumer2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">consumer2_models</span><span class="op">$</span><span class="va">TP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 3</span></span>
<span><span class="co">##  $ 1b : num [1:4002] 4.82 4.76 4.65 4.78 4.94 ...</span></span>
<span><span class="co">##  $ 2b : num [1:4002] 4.71 4.31 4.94 5.22 4.44 ...</span></span>
<span><span class="co">##  $ 2bf: num [1:4002] 5.28 4.88 5.23 5.61 5.03 ...</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># But the names of each variables are the same for both consumers</span></span>
<span><span class="co"># For consumer1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">consumer1_models</span><span class="op">$</span><span class="va">TP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "1b"  "2b"  "2bf"</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For consumer2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">consumer2_models</span><span class="op">$</span><span class="va">TP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "1b"  "2b"  "2bf"</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># So, we change them in order to compare them.</span></span>
<span><span class="co"># To make things clear, consumer 1 will be "Post" and consumer 2 will be</span></span>
<span><span class="co"># "McCutchan". # Also, one baseline Bayesian model will be model1, two </span></span>
<span><span class="co"># baselines model will be model2 and two baselines full model will be model2F</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">consumer1_models</span><span class="op">$</span><span class="va">TP</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Post-model1"</span>, </span>
<span>                                <span class="st">"Post-model2"</span>,</span>
<span>                                <span class="st">"Post-model2F"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">consumer2_models</span><span class="op">$</span><span class="va">TP</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"McCutchan-model1"</span>,</span>
<span>                                <span class="st">"McCutchan-model2"</span>,</span>
<span>                                <span class="st">"McCutchan-model2F"</span><span class="op">)</span></span></code></pre></div>
<p>A useful first step is to summarize the posterior distributions to
get a quantitative idea of how different they are. For this, we will use
the base function (i.e. that comes with R) <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply()</a></code>. This
function is part of the <code>lapply</code> functions that apply a
function (in this case <code>summary</code>) over a list. As we have two
lists (<code>consumer1_models$TP</code> and
<code>consumer2_models$TP</code>) first we need to use the
<code>c</code> operator, that combines them, then we will calculate a
summary for the combined element:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Here we combine posterior estimates of trophic position for both consumers</span></span>
<span><span class="va">combined_models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">consumer1_models</span><span class="op">$</span><span class="va">TP</span>, <span class="va">consumer2_models</span><span class="op">$</span><span class="va">TP</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Then we calculate a summary of posterior trophic position</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">combined_models</span>, <span class="va">summary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         Post-model1 Post-model2 Post-model2F McCutchan-model1 McCutchan-model2</span></span>
<span><span class="co">## Min.       3.608028    3.415638     3.493050         4.085558         4.003042</span></span>
<span><span class="co">## 1st Qu.    3.921280    3.756448     3.806252         4.808365         4.550024</span></span>
<span><span class="co">## Median     4.002738    3.827421     3.885791         4.986985         4.712765</span></span>
<span><span class="co">## Mean       4.006179    3.830818     3.888840         5.006483         4.733087</span></span>
<span><span class="co">## 3rd Qu.    4.084321    3.901013     3.962907         5.173656         4.899018</span></span>
<span><span class="co">## Max.       4.435879    4.246032     4.453742         6.580966         6.433009</span></span>
<span><span class="co">##         McCutchan-model2F</span></span>
<span><span class="co">## Min.             4.093534</span></span>
<span><span class="co">## 1st Qu.          4.685633</span></span>
<span><span class="co">## Median           4.856066</span></span>
<span><span class="co">## Mean             4.875364</span></span>
<span><span class="co">## 3rd Qu.          5.045211</span></span>
<span><span class="co">## Max.             6.257308</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># And we calculate the modes</span></span>
<span><span class="fu"><a href="../reference/getPosteriorMode.html">getPosteriorMode</a></span><span class="op">(</span><span class="va">combined_models</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                Post.model1 Post.model2 Post.model2F McCutchan.model1</span></span>
<span><span class="co">## Posterior mode       4.003       3.824        3.895            4.956</span></span>
<span><span class="co">##                McCutchan.model2 McCutchan.model2F</span></span>
<span><span class="co">## Posterior mode            4.671             4.827</span></span></code></pre>
<p>Here we have a rudimentary summaries of posterior trophic position
estimates associated with each model for both consumers. For example,
the median TP for consumer 1 based on the one baseline model
(Post-model1) is higher than consumer 1 calculated with both 2 baselines
(Post-model2) and 2 baselines full (Post-model2F) models. It appears
that the same is true for consumer 2, where median TP estimated for the
one baseline model (McCutchan-model1) is higher than that for both two
baselines model (McCutchan-model2 and McCutchan-model2F).</p>
<p>As we are operating in a Bayesian universe, there is little sense to
state a threshold under or above which both distributions will be
considered different (as used in a frequentist universe e.g. p &gt;
0.05). Instead, we think rather of comparing posterior distributions.
For example, we can say that two posterior trophic position estimates
will be considered different if their samples of posterior distributions
are 100% different. In this stringent case and considering Post-model1
and McCutchan-model1 posterior estimates of trophic position, we would
expect then that all the posterior estimates of Post-model1 are lesser
than posterior estimates of McCutchan-model1.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compareTwoDistributions.html">compareTwoDistributions</a></span><span class="op">(</span><span class="va">combined_models</span><span class="op">$</span><span class="st">"Post-model1"</span>,</span>
<span>                        <span class="va">combined_models</span><span class="op">$</span><span class="st">"McCutchan-model1"</span>, </span>
<span>                        test <span class="op">=</span> <span class="st">"&lt;="</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
<p>Above, we can see that trophic position posterior estimate of one
baseline model using Post’s (2002) TDF assumptions has a proportion of
4000 observations over the 4000 we sampled (i.e. 4000 / 4000 = 1) that
are lesser or equal than trophic position posterior estimate of the same
one baseline model but using McCutchan’s (2003) TDF assumptions. Thus,
we are pretty confident that posterior estimation of trophic position
calculated with one baseline Bayesian model with Post’s (2000)
assumptions is higher than posterior estimation of trophic position
calculated with McCutchan’s TDF assumptions. Remember that this is the
same simulated fish consumer, in the same simple ecosystem, only
considering differents TDF assumptions.</p>
<p>By default <code><a href="../reference/compareTwoDistributions.html">compareTwoDistributions()</a></code> evaluates how many
observations from <code>combined_models$"Post-model1"</code> are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≤</mo><annotation encoding="application/x-tex">\leq</annotation></semantics></math>
(less than or equal) than
<code>combined_models$"McCutchan-model1"</code>, randomly drawn from
each of the models posterior distribution. We can change to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≥</mo><annotation encoding="application/x-tex">\geq</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>&lt;</mo><annotation encoding="application/x-tex">&lt;</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>&gt;</mo><annotation encoding="application/x-tex">&gt;</annotation></semantics></math>
stating the argument within <code>pairwiseComparisons</code> function
(add <code>test = "&gt;="</code>, for example).</p>
<p>We can make a more detailed comparison of the different models and
TDFs using the <code>pairwiseComparisons</code>() function, which as its
name suggests, produces a matrix of of pairwise comparisons:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pairwiseComparisons.html">pairwiseComparisons</a></span><span class="op">(</span><span class="va">combined_models</span>, test <span class="op">=</span> <span class="st">"&lt;="</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                         [1]   [2]   [3]   [4]   [5]   [6]</span></span>
<span><span class="co">## [1] Post-model1       0.000 0.135 0.241 1.000 0.998 1.000</span></span>
<span><span class="co">## [2] Post-model2       0.865 0.000 0.639 1.000 1.000 1.000</span></span>
<span><span class="co">## [3] Post-model2F      0.759 0.361 0.000 1.000 1.000 1.000</span></span>
<span><span class="co">## [4] McCutchan-model1  0.000 0.000 0.000 0.000 0.231 0.371</span></span>
<span><span class="co">## [5] McCutchan-model2  0.002 0.000 0.000 0.769 0.000 0.647</span></span>
<span><span class="co">## [6] McCutchan-model2F 0.000 0.000 0.000 0.629 0.353 0.000</span></span></code></pre>
<p>The matrix generated by this function is symmetrical, below the
diagonal we have the results of quatifying the proportion of posterior
samples of the model in row are less or equal than posterior samples of
the model in the column, while above the diagonal we have the results of
quantifying the proportion of posterior samples of the model in the
column are higher than posterior samples of the model in the row.</p>
</div>
</div>
<div class="section level2">
<h2 id="parametric-trophic-position">Parametric trophic position<a class="anchor" aria-label="anchor" href="#parametric-trophic-position"></a>
</h2>
<p>As an appendix, we will calculate the parametric (i.e. non-Bayesian)
version of trophic position. For this, we have to iterate through each
consumer, and do the calculation with <code><a href="../reference/parametricTP.html">parametricTP()</a></code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First we combine both consumers' isotope values into a named list</span></span>
<span><span class="va">consumers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"consumer1"</span> <span class="op">=</span> <span class="va">consumer1</span>, <span class="st">"consumer2"</span> <span class="op">=</span> <span class="va">consumer2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># And then, we calculate parametric TP using a loop for</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">consumer</span> <span class="kw">in</span> <span class="va">consumers</span><span class="op">)</span> <span class="fu"><a href="../reference/parametricTP.html">parametricTP</a></span><span class="op">(</span><span class="va">consumer</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "***************************************"</span></span>
<span><span class="co">## [1] "Parametric version of trophic position"</span></span>
<span><span class="co">## [1] "For consumer:  Consumer 1"</span></span>
<span><span class="co">## [1] "One baseline TP:  4"</span></span>
<span><span class="co">## [1] "Two baselines TP:  3.82 0.5"</span></span>
<span><span class="co">## [1] "Full model TP. At the beginning:  3.82 0.662"</span></span>
<span><span class="co">## [1] "Convergence after  8  iterations. TP:  3.88  alpha:  0.665"</span></span>
<span><span class="co">## [1] "***************************************"</span></span>
<span><span class="co">## [1] "Parametric version of trophic position"</span></span>
<span><span class="co">## [1] "For consumer:  Consumer 2"</span></span>
<span><span class="co">## [1] "One baseline TP:  4.96"</span></span>
<span><span class="co">## [1] "Two baselines TP:  4.7 0.5"</span></span>
<span><span class="co">## [1] "Full model TP. At the beginning:  4.7 0.755"</span></span>
<span><span class="co">## [1] "Convergence after  10  iterations. TP:  4.83  alpha:  0.763"</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Claudio Quezada-Romegialli.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
