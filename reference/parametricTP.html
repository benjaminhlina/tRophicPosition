<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Parametric trophic position — parametricTP • tRophicPosition</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parametric trophic position — parametricTP"><meta name="description" content="Calculation of parametric trophic position (with means) partially based on
Post (2002: Using Stable Isotopes to Estimate Trophic Position: Models,
Methods, and Assumptions. Ecology 83, 703)."><meta property="og:description" content="Calculation of parametric trophic position (with means) partially based on
Post (2002: Using Stable Isotopes to Estimate Trophic Position: Models,
Methods, and Assumptions. Ecology 83, 703)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tRophicPosition</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Multiple_model_calculation_of_trophic_position_in_R.html">Using tRophicPosition to estimate TP through the use of multiple models</a></li>
    <li><a class="dropdown-item" href="../articles/Multiple_species_calculation_of_trophic_position_in_R_1.html">tRophicPosition: calculating trophic position for multiple species</a></li>
    <li><a class="dropdown-item" href="../articles/Short_guide_to_tRophicPosition.html">Short guide to the use of tRophicPosition</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/clquezada/tRophicPosition/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Parametric trophic position</h1>
      <small class="dont-index">Source: <a href="https://github.com/clquezada/tRophicPosition/blob/master/R/parametricTP.R" class="external-link"><code>R/parametricTP.R</code></a></small>
      <div class="d-none name"><code>parametricTP.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculation of parametric trophic position (with means) partially based on
Post (2002: Using Stable Isotopes to Estimate Trophic Position: Models,
Methods, and Assumptions. Ecology 83, 703).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">parametricTP</span><span class="op">(</span><span class="va">siData</span>, lambda <span class="op">=</span> <span class="fl">2</span>, print <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sidata">siData<a class="anchor" aria-label="anchor" href="#arg-sidata"></a></dt>
<dd><p>an isotopeData class object.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>numerical value representing trophic level of baseline(s).</p></dd>


<dt id="arg-print">print<a class="anchor" aria-label="anchor" href="#arg-print"></a></dt>
<dd><p>a logical value to indicate whether the output is printed or
not.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list with parametric trophic position calculated with a one
  baseline model, a two baselines model and its alpha value, and a two
  baselines full model and its alpha value.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In case of the one baseline model, trophic position is calculated as $$TP
= lambda + ((dNc - dNb1) / deltaN)$$ where lambda is trophic level of baseline
1, dNc are d15N values of consumer, dNb1 are d15N values of baseline 1 and
deltaN are trophic discrimination factor values of N.</p>

<p>In case of the two baselines model, trophic position is calculated as
$$TP = lambda + ((dNc - ((dNb1 * alpha) + (dNb2 * (1 - alpha)))) /
deltaN)$$ and $$alpha = (dCc - dCb2) / (dCb1 - dCb2)$$ Additional variables
are dCc (d13C values of consumer), dNb2 (d15N values of baseline 2), alpha
(relative contribution of N from baseline 1), and dCb1 and dCb2 (d13C values
of baselines 1 and 2 respectively).</p>

<p>In case of the two baselines full model, trophic position is calculated with
the same equation as the two baselines model, but alpha is calculated as
$$alpha = ((dCc - (deltaC * TP / lambda)) - dCb2) / (dCb1 - dCb2)$$ and
includes deltaC (trophic discrimination factor for C).</p>
<p>In all cases trophic position is calculated based on means of isotope values
and trophic discrimination factors. For the two baselines full model, an
iteration is needed to get convergence of trophic position, starting with
alpha calculated with the two baselines simple model. If no convergence is
gotten after 50 iterations a message is plotted and both alpha and trophic
position are printed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">consumer</span> <span class="op">&lt;-</span> <span class="fu"><a href="generateTPData.html">generateTPData</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">parametricTP</span><span class="op">(</span><span class="va">consumer</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "***************************************"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Parametric version of trophic position"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "For consumer:  "</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "One baseline TP:  4"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Two baselines TP:  4.65 0.304"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Full model TP. At the beginning:  4.65 0.33"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Convergence after  6  iterations. TP:  4.62  alpha:  0.33"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.646152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3042285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.622406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3297974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Claudio Quezada-Romegialli.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

